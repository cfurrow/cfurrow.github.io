<!DOCTYPE html>
<html>
<!--
====================================================
Theme Author Name: Hossain Mohammad Faysal
Profile: https://www.facebook.com/hmfaysal
Version: 1.0
====================================================
-->
<head>
<meta charset="utf-8">
<title>MACOS SIERRA: KILLING MY CPU &vert; CARL FURROW</title>
<meta name="description" content="After the upgrade, I had 200% CPU usage for over a week.">
<meta name="keywords" content="macos, sierra, osx, high-cpu">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cfurrow.github.io/images/27/hero.png">

<meta name="twitter:title" content="macOS Sierra: Killing my CPU">
<meta name="twitter:description" content="After the upgrade, I had 200% CPU usage for over a week.">
<meta name="twitter:creator" content="@carl_furrow">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="macOS Sierra: Killing my CPU">
<meta property="og:description" content="After the upgrade, I had 200% CPU usage for over a week.">
<meta property="og:url" content="https://cfurrow.github.io/osx/2016/09/29/macos-sierra-killing-my-cpu">
<meta property="og:site_name" content="Carl Furrow">

<meta property="og:image" content="https://cfurrow.github.io/images/27/hero.png">






<link rel="canonical" href="https://cfurrow.github.io/osx/2016/09/29/macos-sierra-killing-my-cpu">
<link href="https://cfurrow.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Carl Furrow Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />


<link href='//fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://cfurrow.github.io/assets/css/vendor/font-awesome.min.css">
<link rel="stylesheet" href="https://cfurrow.github.io/assets/css/vendor/normalize.css">
<link rel="stylesheet" href="https://cfurrow.github.io/assets/css/vendor/nprogress.css">
<link rel="stylesheet" href="https://cfurrow.github.io/assets/css/vendor/foundation.min.css">
<link rel="stylesheet" href="https://cfurrow.github.io/assets/css/style.css">
<link rel="stylesheet" href="https://cfurrow.github.io/assets/css/post.css">




<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="https://cfurrow.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="https://cfurrow.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://cfurrow.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://cfurrow.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://cfurrow.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://cfurrow.github.io/images/apple-touch-icon-144x144-precomposed.png">

<style type="text/css">@media only screen and (min-width:43.75em){.notepad-post-content div>p:first-child:first-letter{float:left;font-size:4.688rem;line-height:4.375rem;padding-top:.25rem;padding-right:.5rem;padding-left:.188rem;font-family:serif}}</style>
</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">

        <main id="notepad-post-container" class="notepad-post-container intro-effect-sliced" role="main">
            <header class="notepad-post-header">
                <div class="bg-img"></div>

                <div class="notepad-post-menu-header">

                    <a class="notepad-blog-logo" href="https://cfurrow.github.io">
                        <img src="https://cfurrow.github.io/images/logo.png" alt="Blog Logo" />
                    </a>

                <div class="notepad-blog-menu">
    <div class="notepad-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="notepad-menu">
        <li class="notepad-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="https://cfurrow.github.io/">Home</a>
                 </li>

            <li>
                    <a href="https://cfurrow.github.io/featured">Featured Posts</a>
                 </li>

            <li>
                    <a href="https://cfurrow.github.io/tags">Tags</a>
                 </li>

            <li>
                    <a href="https://cfurrow.github.io/about">About</a>
                 </li>

           <li><a href="https://cfurrow.github.io/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

            <div class="notepad-post-title bg-check">
                <h1>macOS Sierra: Killing my CPU</h1>
                <p>by <strong>Carl Furrow</strong> &#8212; on <a href="https://cfurrow.github.io/tags/index.html#macos" data-toggle="tooltip" title="Posts tagged with macos" rel="tag">macos</a>&nbsp;&comma;&nbsp;<a href="https://cfurrow.github.io/tags/index.html#sierra" data-toggle="tooltip" title="Posts tagged with sierra" rel="tag">sierra</a>&nbsp;&comma;&nbsp;<a href="https://cfurrow.github.io/tags/index.html#osx" data-toggle="tooltip" title="Posts tagged with osx" rel="tag">osx</a>&nbsp;&comma;&nbsp;<a href="https://cfurrow.github.io/tags/index.html#high-cpu" data-toggle="tooltip" title="Posts tagged with high-cpu" rel="tag">high-cpu</a> <strong><time datetime="2016-09-29T00:00:00-04:00">29 Sep 2016</time></strong></p>
            </div>
            <div class="bg-img"></div>
        </header>
        <button class="trigger bg-check" data-info="Read more"><span>Trigger</span></button>
        <img src="https://cfurrow.github.io/images/27/hero.png" alt="cover-image" />

        <article class="notepad-post-content post">
            <div><p>After upgrading to macOS Sierra last week, my 2012 Macbook Air was running at 200%+ CPU practically all day, every day.
Top offenders were:</p>

<p><a href="#the-fix"><em>TL;DR</em></a></p>

<ul>
  <li>mds</li>
  <li>mds_stores</li>
  <li>mdworker</li>
  <li>photolibraryd</li>
  <li>photoanalysisd</li>
  <li>CalNCService</li>
  <li>CalendarAgent</li>
  <li>soagent</li>
  <li>accountsd</li>
  <li>kernel_task</li>
</ul>

<p>Each one of those, or groups of them, would take up 100-170% of my CPU power for themselves for hours on end. I’d even
leave my computer running overnight (thanks to <a href="http://lightheadsw.com/caffeine/">Caffeine</a>) and I’d come back, 8 hours
later to the laptop fans still running high, and CPU pegged at 200%.</p>

<p>I believe there was <em>some</em> explanation for part of this high usage: I used iCloud Photos for a number of years, but almost a year
ago, I stopped auto-syncing photos to it, and tried to use Google Photos exclusively for storage, photo analysis, and
sharing. I was pretty happy with its feature set, and wished the Photos.app could do what Google Photos seemed to do in
stride. Then macOS Sierra was announced, and the new Photos.app features seemed to address my concerns, and I began to
dread the upcoming migration <em>back</em> to Photos.app from Google Photos. What made that easier was <a href="https://support.google.com/photos/answer/6156103?co=GENIE.Platform%3DDesktop&amp;hl=en&amp;oco=0">setting up Google Drive to show
me my photos</a>, and then download
the missing months of photos directly from there, and importing into Photos.app. That is why, I presume, phtolibraryd
and photoanalysisd were crunching hard through all 40,000+ photos in my library. I assume they were uploading new photos,
analyzing the contents of old photos/videos as far back as 2007, finding faces, trees, dogs, etc. But the other apps? WTF?</p>

<h1 id="the-fix-so-far">The “fix” (so far)</h1>
<p><a name="the-fix"></a></p>

<h2 id="photos">Photos</h2>
<p>As far as photolibraryd and photoanalysisd, I think I had to wait those out for the most part. They still run at over 100%
every now and then, but it’s not constant. It’s making progress, from what I can surmise from the “People” album. Each
time I click on it, the numbers of scanned vs unscanned change. I believe I’m going to have to wait this one out and
leave my laptop idling overnight so Photos can continue scanning faces, etc from photos and videos</p>

<image src="/assets/photos/2016.09.29-sierra/photos-face-scanning.svg" width="100%" />

<h2 id="calendarcontacts">Calendar/Contacts</h2>
<p>I had a hunch that somehow my iCloud + Google contacts/calendars was bugged after the macOS upgrade. I did some searching
and I took the advice people gave from past OSX upgrades that also saw high cpu usage from contacts/calendar processes:</p>

<ul>
  <li>Create a new account on your Mac</li>
  <li>Log out of your main Mac user</li>
  <li>Log into the newly created account</li>
  <li>Watch “Activity Monitor” for similar behavior (e.g. high cpu usage)</li>
</ul>

<p>Nothing happened. All processes were using relatively low CPU usage for over 20 minutes (&lt;1%). That confirmed to me that
the problems were definitely user-account specific, and not a problem with macOS or my hardware. I logged out, and back
into my main account. From there, I did the following:</p>

<ul>
  <li>Opened up System Preferences -&gt; Internet Accounts</li>
  <li>Deleted all Google accounts I had listed (selected the account, and then pressed the minus button at the bottom of the list)</li>
  <li>Unchecked “Mail”, “Contacts”, “Calendars”, “Reminders”, “Notes” from my iCloud account</li>
  <li>Reboot</li>
  <li>Go back to System Preferences -&gt; Internet Accounts</li>
  <li>Re-enable iCloud “Mail”, “Contacts”, “Calendars”, “Reminders”, “Notes”</li>
  <li>Watch Activity Monitor for ~10minutes for high CPU usage (none came outside of photoanalysisd)</li>
  <li>Re-add my Google accounts, one at a time, watching Activity Monitor between each add.</li>
</ul>

<p>It seemed my high CPU usage was over, for the most part. Like I said, the Photos-related services spike usage every
now and then, but my fan has quieted down all day today.</p>

            </div>
        </article>
        <div class="cf"></div>

        <div class="cf"></div>

<hr/>
<div class="row newsletter-box">
  <div class="small-12 columns small-centered text-center">
    <i class="fa fa-envelope-o" aria-hidden="true"></i>&nbsp;Want to get updates in your inbox?
    <a href="https://tinyletter.com/furrowcious">Sign up to receive our newsletter!</a>
  </div>
</div>
<div class="notepad-author-info">
  <div class="row">
    <section class="notepad-post-author small-12 columns">
      <img src="https://cfurrow.github.io/images/carl.jpg" class="notepad-post-author-avatar" alt="Carl Furrow's photo">
      <span class="author-label">Author</span>
      <h1>Carl Furrow</h1>
      <p><a href="mailto:hello@carlfurrow.com" class="author-website">hello@carlfurrow.com</a></p>
      <p>I'm just a learning-fool, looking to master the art of solving problems through writing code, and yelling at computer screens.
</p>
    </section>
  </div>
</div>


        <div class="cf"></div>
        
        <div class="cf"></div>

    <footer class="notepad-site-footer">
  <div class="buy-me-a-coffee">
    <style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#FFFFFF !important;background-color:#FF813F !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 1px 9px !important;font-size: 22px !important;letter-spacing: 0.6px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Cookie', cursive !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#FFFFFF !important;}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet"><a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/furrowcious"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"><span style="margin-left:5px">Buy me a coffee</span></a>
  </div>
  <div class="copyright">
    <section>All content copyright <a href="https://cfurrow.github.io/about">Carl Furrow</a> &copy; 2019 &bull; All rights reserved.</section>
    <section>Proudly published with <a class="icon-ghost" href="https://jekyllrb.com/">Jekyll</a></section>
  </div>
  <div class="social-icons">
    
      <a href="http://twitter.com/carl_furrow">
        <span class="fa-stack fa-lg">
          <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
          <i class="fa fa-twitter fa-stack-1x"></i>
        </span>
      </a>
    
    
      <a href="http://instagram.com/furrowcious_carl">
        <span class="fa-stack fa-lg">
          <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
          <i class="fa fa-instagram fa-stack-1x"></i>
        </span>
      </a>
    
    
      <a href="http://github.com/cfurrow">
        <span class="fa-stack fa-lg">
          <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
          <i class="fa fa-github fa-stack-1x"></i>
        </span>
      </a>
    
    
  </div>
  <div class="cf"></div>
</footer>

</main>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="https://cfurrow.github.io/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
<script src="https://cfurrow.github.io/assets/js/vendor/modernizr.js"></script>
<script src="https://cfurrow.github.io/assets/js/foundation.min.js"></script>
<script src="https://cfurrow.github.io/assets/js/vendor/background-check.js"></script>
<script src="https://cfurrow.github.io/assets/js/vendor/post-header-animations.js"></script>
<script src="https://cfurrow.github.io/assets/js/notepad.js"></script>
<script src="https://cfurrow.github.io/assets/js/scripts.min.js"></script>
<script src="https://cfurrow.github.io/assets/js/vendor/nprogress.js"></script>

<script>
  $(document).foundation();
</script>
<script type='text/javascript'>console.log("HMFaysal Notepad Theme Version 2.0");</script>
<script type='text/javascript'>console.log("https://alum.mit.edu/www/hmfaysal");</script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48560508-1', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>

<script>NProgress.start();var interval=setInterval(function(){NProgress.inc()},1000);jQuery(window).load(function(){clearInterval(interval);NProgress.done()});jQuery(window).unload(function(){NProgress.start()});</script>

</body>
</html>
